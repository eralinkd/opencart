<form id="form-product" method="post" data-oc-toggle="ajax" data-oc-load="{{ action }}" data-oc-target="#product">
  <div class="table-responsive">
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th class="text-center" style="width: 1px;" title="Select all products">
            <input type="checkbox" onclick="$('input[name*=\'selected\']').prop('checked', $(this).prop('checked'));" class="form-check-input"/>
          </th>
          <th class="text-center" title="Product image">
            <span class="d-block mb-1">{{ column_image }}</span>
            <small class="text-muted d-block" style="font-size: 11px; font-weight: normal;">Image</small>
          </th>
          <th title="Product name">
            <span class="d-block mb-1"><a href="{{ sort_name }}"{% if sort == 'pd.name' %} class="{{ order|lower }}"{% endif %}>{{ column_name }}</a></span>
            <small class="text-muted d-block" style="font-size: 11px; font-weight: normal;">Click to sort by name</small>
          </th>
          <th class="d-none d-lg-table-cell" title="Product model">
            <span class="d-block mb-1"><a href="{{ sort_model }}"{% if sort == 'p.model' %} class="{{ order|lower }}"{% endif %}>{{ column_model }}</a></span>
            <small class="text-muted d-block" style="font-size: 11px; font-weight: normal;">Product model/SKU</small>
          </th>
          <th class="text-end" title="Product price">
            <span class="d-block mb-1"><a href="{{ sort_price }}"{% if sort == 'p.price' %} class="{{ order|lower }}"{% endif %}>{{ column_price }}</a></span>
            <small class="text-muted d-block" style="font-size: 11px; font-weight: normal;">Price per unit</small>
          </th>
          <th class="text-end" title="Stock quantity">
            <span class="d-block mb-1"><a href="{{ sort_quantity }}"{% if sort == 'p.quantity' %} class="{{ order|lower }}"{% endif %}>{{ column_quantity }}</a></span>
            <small class="text-muted d-block" style="font-size: 11px; font-weight: normal;">Items in stock</small>
          </th>
          <th class="text-end" title="Actions">
            <span class="d-block mb-1">{{ column_action }}</span>
            <small class="text-muted d-block" style="font-size: 11px; font-weight: normal;">Edit product</small>
          </th>
        </tr>
      </thead>
      <tbody>
        {% if products %}
          {% for product in products %}
            <tr class="{% if not product.variant %}table-warning{% endif %} {% if not product.status %}opacity-50{% endif %}">
              <td class="text-center">
                <input type="checkbox" name="selected[]" value="{{ product.product_id }}" class="form-check-input" title="Select this product"/>
              </td>
              <td class="text-center">
                {% if product.image %}
                  <img src="{{ product.image }}" alt="{{ product.name }}" class="img-thumbnail" style="max-width: 60px; max-height: 60px;" title="Product image: {{ product.name }}"/>
                {% else %}
                  <span class="text-muted" style="font-size: 12px;">No image</span>
                {% endif %}
              </td>
              <td>
                <strong>{{ product.name }}</strong>
                {% if not product.status %}
                  <span class="badge bg-danger ms-2" title="This product is disabled">Disabled</span>
                {% else %}
                  <span class="badge bg-success ms-2" title="This product is enabled">Enabled</span>
                {% endif %}
                {% if product.variant %}
                  <span class="badge bg-info ms-2" title="This product has variants">Has Variants</span>
                {% endif %}
              </td>
              <td class="d-none d-lg-table-cell">
                <code style="font-size: 13px;" title="Product model/SKU">{{ product.model ?: 'N/A' }}</code>
              </td>
              <td class="text-end">
                {% if product.special %}
                  <div title="Original price">
                    <span style="text-decoration: line-through; color: #999; font-size: 13px;">{{ product.price }}</span>
                  </div>
                  <div class="text-danger fw-bold" title="Special price">{{ product.special }}</div>
                {% else %}
                  <span class="fw-bold" title="Product price">{{ product.price }}</span>
                {% endif %}
              </td>
              <td class="text-end">
                {% if product.quantity <= 0 %}
                  <span class="badge bg-warning" title="Out of stock - {{ product.quantity }} items">{{ product.quantity }}</span>
                {% elseif product.quantity <= 5 %}
                  <span class="badge bg-danger" title="Low stock - {{ product.quantity }} items remaining">{{ product.quantity }}</span>
                {% else %}
                  <span class="badge bg-success" title="In stock - {{ product.quantity }} items">{{ product.quantity }}</span>
                {% endif %}
              </td>
              <td class="text-end">
                {% if product.variant %}
                  <div class="btn-group">
                    <a href="{{ product.edit }}" data-bs-toggle="tooltip" title="Edit product: {{ product.name }}" class="btn btn-primary btn-sm">
                      <i class="fa-solid fa-pencil"></i> Edit
                    </a>
                    <button type="button" class="btn btn-primary btn-sm dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" title="More options">
                      <i class="fa-solid fa-caret-down"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end">
                      <a href="{{ product.variant }}" class="dropdown-item">
                        <i class="fa-solid fa-plus"></i> {{ text_variant_add }}
                      </a>
                    </div>
                  </div>
                {% else %}
                  <a href="{{ product.edit }}" data-bs-toggle="tooltip" title="Edit product: {{ product.name }}" class="btn btn-primary btn-sm">
                    <i class="fa-solid fa-pencil"></i> Edit
                  </a>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td class="text-center" colspan="7">{{ text_no_results }}</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
  <div class="row">
    <div class="col-sm-6 text-start">{{ pagination }}</div>
    <div class="col-sm-6 text-end">{{ results }}</div>
  </div>
</form>
